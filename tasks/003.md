### **Задача 3: Загрузка страницы видео (YouTube) с обработкой частичных ошибок**

### Решение задачи

```javascript
// Функция, имитирующая запрос деталей видео
function fetchVideoDetails(videoId) {
  return new Promise(resolve => {
    setTimeout(() => {
      console.log(`[Видео ${videoId}] Детали загружены.`);
      resolve({ title: `Видео ${videoId}`, description: 'Очень интересное описание...' });
    }, 1000); // 1 сек
  });
}

// Функция, имитирующая запрос комментариев (может упасть)
function fetchComments(videoId) {
  return new Promise((resolve, reject) => {
    setTimeout(() => {
      const shouldFail = Math.random() < 0.3; // 30% шанс ошибки
      if (shouldFail) {
        console.error(`[Видео ${videoId}] Ошибка загрузки комментариев!`);
        reject(new Error(`Не удалось загрузить комментарии для видео ${videoId}`));
      } else {
        console.log(`[Видео ${videoId}] Комментарии загружены.`);
        resolve(['Класс!', 'Спасибо за видео!', 'Подписался!']);
      }
    }, 1500); // 1.5 сек
  });
}

// Функция, имитирующая запрос похожих видео
function fetchRelatedVideos(videoId) {
  return new Promise(resolve => {
    setTimeout(() => {
      console.log(`[Видео ${videoId}] Похожие видео загружены.`);
      resolve([`Похожее видео 1 (для ${videoId})`, `Похожее видео 2 (для ${videoId})`]);
    }, 800); // 0.8 сек
  });
}

// Асинхронная функция для загрузки всей страницы
async function loadVideoPage(videoId) {
  console.log(`\n--- Загрузка страницы для видео ${videoId} ---`);
  console.time(`LoadTime-${videoId}`); // Замеряем время

  try {
    // Запускаем все запросы параллельно
    // Promise.all ждет выполнения всех или падает при первой ошибке
    const [details, comments, related] = await Promise.all([
      fetchVideoDetails(videoId),
      fetchComments(videoId), // Этот запрос может быть отклонен
      fetchRelatedVideos(videoId)
    ]);

    // Этот блок выполнится только если ВСЕ промисы успешно разрешились (resolve)
    console.log(`\n--- [Видео ${videoId}] Страница загружена УСПЕШНО ---`);
    console.log('Детали видео:', details);
    console.log('Комментарии:', comments);
    console.log('Похожие видео:', related);

  } catch (error) {
    // Этот блок выполнится, если ХОТЯ БЫ ОДИН промис был отклонен (reject)
    console.error(`\n--- [Видео ${videoId}] Ошибка при загрузке страницы ---`);
    console.error('Причина:', error.message);
    console.warn('Не удалось отобразить страницу полностью. Часть данных может отсутствовать.');
    // Важно: При использовании Promise.all, если произошла ошибка,
    // мы не получаем доступа к результатам тех промисов, которые могли успешно завершиться до ошибки.
    // Для получения всех результатов (успешных и неуспешных) используют Promise.allSettled.
  } finally {
    // Этот блок выполнится в любом случае (успех или ошибка)
    console.timeEnd(`LoadTime-${videoId}`); // Завершаем замер времени
    console.log(`--- Загрузка страницы для видео ${videoId} завершена ---`);
  }
}

// Запускаем загрузку для нескольких видео, чтобы увидеть разные исходы
loadVideoPage('id123');
setTimeout(() => loadVideoPage('id456'), 500); // Запустим с небольшой задержкой
setTimeout(() => loadVideoPage('id789'), 1000);

```
