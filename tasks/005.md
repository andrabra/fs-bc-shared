### **–ó–∞–¥–∞—á–∞ 5: –ó–∞–≥—Ä—É–∑–∫–∞ —Å—Ç—Ä–∞–Ω–∏—Ü—ã –∞–ª—å–±–æ–º–∞ —Å –≤—ã–±–æ—Ä–æ–º –±—ã—Å—Ç—Ä—ã—Ö —Ä–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–π –∏ –æ–±—â–∏–º —Ç–∞–π–º–∞—É—Ç–æ–º (–∞-–ª—è –Ø–Ω–¥–µ–∫—Å.–ú—É–∑—ã–∫–∞)**

### –†–µ—à–µ–Ω–∏–µ –∑–∞–¥–∞—á–∏

```javascript
// –§—É–Ω–∫—Ü–∏—è –∏–º–∏—Ç–∞—Ü–∏–∏ –∑–∞–≥—Ä—É–∑–∫–∏ –¥–µ—Ç–∞–ª–µ–π –∞–ª—å–±–æ–º–∞
function fetchAlbumDetails(albumId) {
  return new Promise(resolve => {
    const delay = 800; // 0.8 —Å–µ–∫
    setTimeout(() => {
      console.log(`   [–î–µ—Ç–∞–ª–∏] –î–µ—Ç–∞–ª–∏ –¥–ª—è –∞–ª—å–±–æ–º–∞ "${albumId}" –∑–∞–≥—Ä—É–∂–µ–Ω—ã (–∑–∞ ${delay} –º—Å)`);
      // –ò—Å–ø–æ–ª—å–∑—É–µ–º –∫—Ä–µ–∞—Ç–∏–≤–Ω—ã–µ –Ω–∞–∑–≤–∞–Ω–∏—è –∏–∑ –æ–ø–∏—Å–∞–Ω–∏—è –∑–∞–¥–∞—á–∏
      resolve({
        id: albumId,
        title: '–°–∏–Ω—Ç–∞–∫—Å–∏—á–µ—Å–∫–∏–π –°–∞—Ö–∞—Ä', // –û–±–Ω–æ–≤–ª–µ–Ω–æ
        artist: '–ù–µ–π—Ä–æ—Å–µ—Ç—å –ù–µ–π—Ä–æ–Ω–æ–≤–∏—á', // –û–±–Ω–æ–≤–ª–µ–Ω–æ
        tracks: ['–ê—Å–∏–Ω—Ö—Ä–æ–Ω–Ω–∞—è –ë–∞–ª–ª–∞–¥–∞', '–¶–∏–∫–ª –ë–µ—Å–∫–æ–Ω–µ—á–Ω–æ—Å—Ç–∏', '–ë–∞–≥ –≤ –ú–∞—Ç—Ä–∏—Ü–µ'] // –û–±–Ω–æ–≤–ª–µ–Ω–æ
      });
    }, delay);
  });
}

// –§—É–Ω–∫—Ü–∏—è –∏–º–∏—Ç–∞—Ü–∏–∏ –∑–∞–ø—Ä–æ—Å–∞ —Ä–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–π –æ—Ç –û–î–ù–û–ì–û –¥–≤–∏–∂–∫–∞
function fetchRecommendations(engineId, albumId) {
  return new Promise(resolve => {
    // –°–ª—É—á–∞–π–Ω–∞—è –∑–∞–¥–µ—Ä–∂–∫–∞ –æ—Ç 0.5 –¥–æ 2 —Å–µ–∫—É–Ω–¥
    const delay = Math.random() * 1500 + 500;
    setTimeout(() => {
      console.log(`   [–†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏] –û—Ç–≤–µ—Ç –æ—Ç –¥–≤–∏–∂–∫–∞ ${engineId} –¥–ª—è "${albumId}" –ø–æ–ª—É—á–µ–Ω (–∑–∞ ${delay.toFixed(0)} –º—Å)`);
      resolve({
        engine: engineId, // –ó–∞–ø–æ–º–∏–Ω–∞–µ–º, –∫–∞–∫–æ–π –¥–≤–∏–∂–æ–∫ –æ—Ç–≤–µ—Ç–∏–ª
        albumId: albumId,
        similarAlbums: [
          `–ü–æ—Ö–æ–∂–∏–π –∞–ª—å–±–æ–º 1 (–æ—Ç ${engineId})`,
          `–ü–æ—Ö–æ–∂–∏–π –∞–ª—å–±–æ–º 2 (–æ—Ç ${engineId})`
        ]
      });
    }, delay);
  });
}

// –§—É–Ω–∫—Ü–∏—è, —Å–æ–∑–¥–∞—é—â–∞—è –ø—Ä–æ–º–∏—Å, –∫–æ—Ç–æ—Ä—ã–π –æ—Ç–∫–ª–æ–Ω—è–µ—Ç—Å—è —á–µ—Ä–µ–∑ delay –º—Å
function timeoutPromise(delay, message) {
  return new Promise((_, reject) => {
    setTimeout(() => {
      reject(new Error(message));
    }, delay);
  });
}

// –û—Å–Ω–æ–≤–Ω–∞—è —Ñ—É–Ω–∫—Ü–∏—è –∑–∞–≥—Ä—É–∑–∫–∏ —Å—Ç—Ä–∞–Ω–∏—Ü—ã –∞–ª—å–±–æ–º–∞
async function loadAlbumPage(albumId, recommendationEngines, totalTimeout) {
  console.log(`\n--- –ó–∞–≥—Ä—É–∑–∫–∞ —Å—Ç—Ä–∞–Ω–∏—Ü—ã –¥–ª—è –∞–ª—å–±–æ–º–∞ "${albumId}" ---`);
  console.log(`–î–≤–∏–∂–∫–∏ —Ä–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–π: [${recommendationEngines.join(', ')}]`);
  console.log(`–û–±—â–∏–π —Ç–∞–π–º–∞—É—Ç: ${totalTimeout} –º—Å`);
  const startTime = Date.now();

  try {
    // --- –®–∞–≥ –ê: –û–ø—Ä–µ–¥–µ–ª—è–µ–º –ø—Ä–æ–º–∏—Å –¥–ª—è –ø–æ–ª—É—á–µ–Ω–∏—è —Ä–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–π —Å —Å–∞–º–æ–≥–æ –±—ã—Å—Ç—Ä–æ–≥–æ –¥–≤–∏–∂–∫–∞ ---
    console.log('   –ó–∞–ø—É—Å–∫–∞–µ–º –∑–∞–ø—Ä–æ—Å—ã –∫ –¥–≤–∏–∂–∫–∞–º —Ä–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–π...');
    const fastestRecommendationsPromise = Promise.race(
      recommendationEngines.map(engineId => fetchRecommendations(engineId, albumId))
    );
    // fastestRecommendationsPromise —Ä–∞–∑—Ä–µ—à–∏—Ç—Å—è, –∫–∞–∫ —Ç–æ–ª—å–∫–æ –ü–ï–†–í–´–ô fetchRecommendations –∑–∞–≤–µ—Ä—à–∏—Ç—Å—è

    // --- –®–∞–≥ –ë: –û–ø—Ä–µ–¥–µ–ª—è–µ–º –ø—Ä–æ–º–∏—Å –¥–ª—è –∑–∞–≥—Ä—É–∑–∫–∏ –í–°–ï–• –Ω–µ–æ–±—Ö–æ–¥–∏–º—ã—Ö –¥–∞–Ω–Ω—ã—Ö ---
    console.log('   –ó–∞–ø—É—Å–∫–∞–µ–º –∑–∞–≥—Ä—É–∑–∫—É –¥–µ—Ç–∞–ª–µ–π –∞–ª—å–±–æ–º–∞...');
    const dataFetchPromise = Promise.all([
      fetchAlbumDetails(albumId),       // –ó–∞–ø—Ä–æ—Å –¥–µ—Ç–∞–ª–µ–π
      fastestRecommendationsPromise   // –û–∂–∏–¥–∞–Ω–∏–µ —Å–∞–º—ã—Ö –±—ã—Å—Ç—Ä—ã—Ö —Ä–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–π
    ]);
    // dataFetchPromise —Ä–∞–∑—Ä–µ—à–∏—Ç—Å—è, –∫–æ–≥–¥–∞ –û–ë–ê –ø—Ä–æ–º–∏—Å–∞ –≤–Ω—É—Ç—Ä–∏ –Ω–µ–≥–æ —Ä–∞–∑—Ä–µ—à–∞—Ç—Å—è

    // --- –®–∞–≥ –í: –†–µ–∞–ª–∏–∑–∞—Ü–∏—è –æ–±—â–µ–≥–æ —Ç–∞–π–º–∞—É—Ç–∞ ---
    const overallTimeoutPromise = timeoutPromise(
      totalTimeout,
      `–¢–∞–π–º–∞—É—Ç! –°—Ç—Ä–∞–Ω–∏—Ü–∞ –∞–ª—å–±–æ–º–∞ "${albumId}" –Ω–µ –∑–∞–≥—Ä—É–∑–∏–ª–∞—Å—å –∑–∞ ${totalTimeout} –º—Å.`
    );

    // --- –§–∏–Ω–∞–ª—å–Ω–æ–µ —Å–æ—Ä–µ–≤–Ω–æ–≤–∞–Ω–∏–µ: –¥–∞–Ω–Ω—ã–µ –ò–õ–ò —Ç–∞–π–º–∞—É—Ç ---
    console.log(`   –û–∂–∏–¥–∞–Ω–∏–µ –¥–∞–Ω–Ω—ã—Ö –∏–ª–∏ —Ç–∞–π–º–∞—É—Ç–∞ (${totalTimeout} –º—Å)...`);
    const result = await Promise.race([
      dataFetchPromise,       // –ö—Ç–æ –±—ã—Å—Ç—Ä–µ–µ?
      overallTimeoutPromise   // –ó–∞–≥—Ä—É–∑–∫–∞ –¥–∞–Ω–Ω—ã—Ö –∏–ª–∏ —Ç–∞–π–º–∞—É—Ç?
    ]);

    // –ï—Å–ª–∏ –º—ã –∑–¥–µ—Å—å, –∑–Ω–∞—á–∏—Ç dataFetchPromise —É—Å–ø–µ–ª –∑–∞–≤–µ—Ä—à–∏—Ç—å—Å—è –¥–æ —Ç–∞–π–º–∞—É—Ç–∞
    const [albumDetails, recommendationsData] = result; // –î–µ—Å—Ç—Ä—É–∫—Ç—É—Ä–∏—Ä—É–µ–º —Ä–µ–∑—É–ª—å—Ç–∞—Ç Promise.all
    const endTime = Date.now();

    console.log(`\n--- üéâ –°—Ç—Ä–∞–Ω–∏—Ü–∞ –∞–ª—å–±–æ–º–∞ "${albumId}" –£–°–ü–ï–®–ù–û –∑–∞–≥—Ä—É–∂–µ–Ω–∞! ---`);
    // –í—ã–≤–æ–¥–∏–º –æ–±–Ω–æ–≤–ª–µ–Ω–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ
    console.log(`–ò—Å–ø–æ–ª–Ω–∏—Ç–µ–ª—å: ${albumDetails.artist}`);
    console.log(`–ê–ª—å–±–æ–º: ${albumDetails.title}`);
    console.log(`–¢—Ä–µ–∫–∏: ${albumDetails.tracks.join(', ')}`);
    console.log(`–†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏ (–æ—Ç –¥–≤–∏–∂–∫–∞: ${recommendationsData.engine}): ${recommendationsData.similarAlbums.join(', ')}`);
    console.log(`–û–±—â–µ–µ –≤—Ä–µ–º—è –∑–∞–≥—Ä—É–∑–∫–∏: ${(endTime - startTime)} –º—Å`);
    return { albumDetails, recommendationsData };

  } catch (error) {
    // –°—é–¥–∞ –ø–æ–ø–∞–¥–∞–µ–º, –µ—Å–ª–∏ overallTimeoutPromise —Å—Ä–∞–±–æ—Ç–∞–ª –ø–µ—Ä–≤—ã–º,
    // –∏–ª–∏ –µ—Å–ª–∏ –ø—Ä–æ–∏–∑–æ—à–ª–∞ –æ—à–∏–±–∫–∞ –≤–Ω—É—Ç—Ä–∏ fetchAlbumDetails (–º–∞–ª–æ–≤–µ—Ä–æ—è—Ç–Ω–æ)
    // –∏–ª–∏ –µ—Å–ª–∏ Promise.race –¥–ª—è —Ä–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–π –æ—Ç–∫–ª–æ–Ω–∏–ª—Å—è (—Ç–æ–∂–µ –º–∞–ª–æ–≤–µ—Ä–æ—è—Ç–Ω–æ –∑–¥–µ—Å—å)
    const endTime = Date.now();
    console.error(`\n--- ‚ùå –û—à–∏–±–∫–∞ –∑–∞–≥—Ä—É–∑–∫–∏ —Å—Ç—Ä–∞–Ω–∏—Ü—ã –∞–ª—å–±–æ–º–∞ "${albumId}"! ---`);
    console.error(`–ü—Ä–∏—á–∏–Ω–∞: ${error.message}`);
    console.log(`–í—Ä–µ–º—è –¥–æ –æ—à–∏–±–∫–∏: ${(endTime - startTime)} –º—Å`);
    return null;
  }
}

// --- –ü—Ä–∏–º–µ—Ä—ã –≤—ã–∑–æ–≤–∞ ---
const engines = ['–±—ã—Å—Ç—Ä—ã–π-A', '—Å—Ä–µ–¥–Ω–∏–π-B', '–º–µ–¥–ª–µ–Ω–Ω—ã–π-C'];

// –ü—Ä–∏–º–µ—Ä 1: –¢–∞–π–º–∞—É—Ç –¥–æ—Å—Ç–∞—Ç–æ—á–Ω–æ –±–æ–ª—å—à–æ–π (–≤–µ—Ä–æ—è—Ç–Ω–æ, —É—Å–ø–µ–µ—Ç)
// –ò—Å–ø–æ–ª—å–∑—É–µ–º ID '–°–∏–Ω—Ç–∞–∫—Å–∏—á–µ—Å–∫–∏–π –°–∞—Ö–∞—Ä' –¥–ª—è —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤–∏—è –¥–∞–Ω–Ω—ã–º –≤ fetchAlbumDetails
loadAlbumPage('–°–∏–Ω—Ç–∞–∫—Å–∏—á–µ—Å–∫–∏–π –°–∞—Ö–∞—Ä', engines, 2500);

// –ü—Ä–∏–º–µ—Ä 2: –¢–∞–π–º–∞—É—Ç –º–∞–ª–µ–Ω—å–∫–∏–π (–≤–µ—Ä–æ—è—Ç–Ω–æ, –ù–ï —É—Å–ø–µ–µ—Ç)
setTimeout(() => {
  // –ò—Å–ø–æ–ª—å–∑—É–µ–º –¥—Ä—É–≥–æ–π ID –¥–ª—è –≤—Ç–æ—Ä–æ–≥–æ –ø—Ä–∏–º–µ—Ä–∞
  loadAlbumPage('–†–µ—Ñ–∞–∫—Ç–æ—Ä–∏–Ω–≥ –†–µ–º–∏–∫—Å', engines, 1000); // –¢–∞–π–º–∞—É—Ç –≤—Å–µ–≥–æ 1 —Å–µ–∫—É–Ω–¥–∞
}, 3000); // –ó–∞–ø—É—Å–∫–∞–µ–º —á–µ—Ä–µ–∑ 3 —Å–µ–∫, —á—Ç–æ–±—ã –æ—Ç–¥–µ–ª–∏—Ç—å –ª–æ–≥–∏

```
